<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Security-Policy">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model checking</title>
</head>
<body>
    <p>Process: <span id="proc-info">-</span></p>
    <p>Status: <span id="check-status">-</span></p>
    <h2>States</h2>
    <p>Found: <span id="init-states-count">-</span></p>
    <table>
        <thead>
            <tr>
                <td>Time</td>
                <td>Diameter</td>
                <td>Found</td>
                <td>Distinct</td>
                <td>Queue</td>
            </tr>
        </thead>
        <tbody id="states-stat">
        </tbody>
    </table>
    <h2>Coverage</h2>
    <table>
            <thead>
                <tr>
                    <td>Module</td>
                    <td>Action</td>
                    <td>Location</td>
                    <td>Total</td>
                    <td>Distinct</td>
                </tr>
            </thead>
            <tbody id="coverage-stat">
            </tbody>
        </table>
    </body>
<script>
    const vscode = acquireVsCodeApi();

    const elStatus = document.getElementById('check-status');
    const elProcInfo = document.getElementById('proc-info');
    const elInitStates = document.getElementById('init-states-count');
    const elStatesStat = document.getElementById('states-stat');
    const elCoverageStat = document.getElementById('coverage-stat');

    const prevState = vscode.getState();
    if (prevState) {
        updateCheckResult(prevState.checkResult);
    }

    function updateCheckResult(res) {
        elProcInfo.textContent = res.processInfo;
        elStatus.textContent = res.status;
        elInitStates.textContent = res.initialStatesCount;
        elStatesStat.innerHTML = res.initialStatesStat
            .map(s => `<tr><td>${s.time}</td><td>${s.diameter}</td><td>${s.total}</td><td>${s.distinct}</td><td>${s.queueSize}</td></tr>`)
            .join('');
        elCoverageStat.innerHTML = res.coverageStat
            .map(s => `<tr><td>${s.module}</td><td>${s.action}</td><td>${s.location}</td><td>${s.total}</td><td>${s.distinct}</td></tr>`)
            .join('');
    }

    window.addEventListener('message', event => {
        updateCheckResult(event.data.checkResult);
        vscode.setState(event.data);
    });
</script>
